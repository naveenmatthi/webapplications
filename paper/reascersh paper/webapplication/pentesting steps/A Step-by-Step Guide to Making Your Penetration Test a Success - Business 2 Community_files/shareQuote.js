window.postPlatformApp.register("shareQuote",function(d){var l,m,g,h,n,k,p,c=d._,e;l=d.ext.i18n.t("powered");m=d.ext.i18n.t("shareTitle");h="facebook twitter email gmail tumblr googlebookmarks linkedin blogger yahoomail aollifestream delicious outlook aolmail livejournal vkontakte baidu mailru meinvz skyrock weibo kaixin whatsapp sms line mixi wordpress".split(" ");n=["facebook","twitter","email","more"];k=["more","post"];p={buttonBackground:"none",layout:"horizontal",jumbo:!1,label:!1,counter:!1,
padding:!1,hover:!0,size:32,afterShareOptions:{center:!0},popup:{center:!0,overlay:!0,click:!0}};g=c.isMobile()?"touchend":"click";e={init:function(a){this.widgetId="pw"+c.getGUID().substr(0,10);d.state.set(a);d.subscribe({"shareQuote.show":this.show.bind(this)})},destroy:function(){},getAnchorPoints:function(){var a=window.getSelection().getRangeAt(0).cloneRange(),b=c.createNode("span");a.collapse(!1);a.insertNode(b);a=c.getOffsetRect(b);this.fixOrientation(a);c.destroyNode(b);return a},fixOrientation:function(a){var b=
c.getScrollPosition(),b=window.innerHeight+b.y,d;185>a.left&&(a.left=195);a.top+54>b&&(a.top-=72,d="bottom");this.setClassList(d)},setClassList:function(a){c.setClass(this.popup,["__pw-position-"+(a||"top"),"pw-sharequote"].join(" "))},getPopupPosition:function(a){return{left:a.left-5-185+"px",top:a.top+5+18+(c.iosDevice(["iphone"])?10:0)+"px"}},togglePopup:function(a,b){var d=c.get(a)[0];d&&(d.style.display=b?"none":"block")},getPopupServices:function(){var a=d.state.get("morePopupExclude")||[];
return c.filter(h,function(b){return 0>a.indexOf(b)})},show:function(a){var b=this;a=a.copiedText;var f=[],e={};b.popup?(window.postPlatform.updateWidget("#"+this.widgetId,{description:a||"",buttons:d.state.get("buttons"),url:d.ext.pwConfig.val("defaults.url")}),this.removeBodyEvent()):(b.popup=c.createNode("div.pw-sharequote",{innerHTML:c.t('\x3cdiv class\x3d"pw-sharequote-crn"\x3e\x3cdiv class\x3d"pw-sharequote-crn__outer"\x3e\x3cdiv class\x3d"pw-sharequote-crn__inner"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"pw-sharequote__outer"\x3e\x3cdiv class\x3d"pw-sharequote__inner"\x3e\x3cdiv id\x3d"{widgetId}"\x3e\x3c/div\x3e\x3cspan role\x3d"button" class\x3d"pw-sharequote-close"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',
{shareTitle:m,poStLink:"http://www.po.st",powered:l,widgetId:this.widgetId})}),c.appendTo("body",b.popup),c.on(c.get(".pw-sharequote-close",b.popup)[0],"click",function(){b.togglePopup(b.popup,!0)}),c.each(d.state.get("buttons")||[],function(a){(-1!==h.indexOf(a)||a.indexOf(k))&&f.push(a)}),d.state.set({buttons:c.isArray(f)&&0<f.length?f:n}),e={buttons:d.state.get("buttons"),description:a||"",popup:{services:{display:b.getPopupServices(),exclude:[]}},rules:{hideOnUrls:[]},handlers:{onhideaftershare:function(a){b.doUserCallback("onhideaftershare",
a)},onbuttonclick:function(a){c.isMobile()?b.togglePopup(b.popup,!0):(a.service.indexOf(k)||"email"===a.service)&&b.togglePopup(b.popup,!0);b.doUserCallback("onbuttonclick",a);b.removeBodyEvent()}}},d.state.get("services.twitter.via")&&(e.services={twitter:{via:d.state.get("services.twitter.via")}}),window.postPlatform.createWidget("#"+this.widgetId,c.extend(e,p)));this.togglePopup(this.popup);c.setStyle(this.popup,this.getPopupPosition(this.getAnchorPoints()));setTimeout(function(){this.onBodyClick=
c.on(document.body,g,function(a){c.parent(a.target,".pw-sharequote")||b.togglePopup(b.popup,!0)})}.bind(this),50)},doUserCallback:function(a,b){c.doFunction(d.ext.pwConfig.val("defaults.handlers."+a),b)},removeBodyEvent:function(){c.off(document.body,g,this.onBodyClick)}};return{init:function(){d.subscribe("shareQuote.init",function(a){e.init(a.options)})},destroy:function(){e.destroy()}}});